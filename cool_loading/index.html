<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<title>coolloading_one</title>
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="initial-scale=1, maximum-scale=1">
	<meta name="apple-mobile-web-app-capable" content="yes">
	<meta name="apple-mobile-web-app-status-bar-style" content="black">
	<meta name="format-detection" content="telephone=no, email=no"/> 
	<style type="text/css" media="screen">
		a{
			display: inline-block;
			border: 0;
			border-radius: 5px;
			padding: 0 1.32em;
			line-height: 2.3;
			font-size: 3.2vw;
		}
		.btn_openLoading{
			background-color: #16d23e;
			color: #fff;
		}
		.btn_openMaskLoading{
			background-color: #888;
			color: #fff;
		}
		.btn_hideLoading{
			background-color: #e64340;
			color: #fff;
		}
	</style>	 
</head>
<body ontouchstart="">
	<div style="text-align: center;">
		<h3>1.进度条加载效果</h3>
		<a id="btn_openLoading" class="btn_openLoading" data-fileSource="loading.js">打开loading</a>
		<a id="btn_openMaskLoading" class="btn_openMaskLoading" data-fileSource="loading.js">打开maskloading</a>
		<a id="btn_hideLoading" class="btn_hideLoading" data-fileSource="loading.js">关闭loading</a>
	</div>
	<div style="text-align: center;">
		<h3>2.翻转加载效果</h3>
		<a id="btn_openLoading" class="btn_openLoading" data-fileSource="loading2.js">打开loading</a>
		<a id="btn_openMaskLoading" class="btn_openMaskLoading" data-fileSource="loading2.js">打开maskloading</a>
		<a id="btn_hideLoading" class="btn_hideLoading" data-fileSource="loading2.js">关闭loading</a>
	</div>
	<div style="text-align: center;">
		<h3>3.圆形大小渐变效果</h3>
		<a id="btn_openLoading" class="btn_openLoading" data-fileSource="loading3.js">打开loading</a>
		<a id="btn_openMaskLoading" class="btn_openMaskLoading" data-fileSource="loading3.js">打开maskloading</a>
		<a id="btn_hideLoading" class="btn_hideLoading" data-fileSource="loading3.js">关闭loading</a>
	</div>
	<div style="text-align: center;">
		<h3>4.方块互换渐变效果</h3>
		<a id="btn_openLoading" class="btn_openLoading" data-fileSource="loading4.js">打开loading</a>
		<a id="btn_openMaskLoading" class="btn_openMaskLoading" data-fileSource="loading4.js">打开maskloading</a>
		<a id="btn_hideLoading" class="btn_hideLoading" data-fileSource="loading4.js">关闭loading</a>
	</div>
	<div style="text-align: center;">
		<h3>5.圆形互换渐变效果</h3>
		<a id="btn_openLoading" class="btn_openLoading" data-fileSource="loading5.js">打开loading</a>
		<a id="btn_openMaskLoading" class="btn_openMaskLoading" data-fileSource="loading5.js">打开maskloading</a>
		<a id="btn_hideLoading" class="btn_hideLoading" data-fileSource="loading5.js">关闭loading</a>
	</div>
	<div style="text-align: center;">
		<h3>6.三圆渐进效果</h3>
		<a id="btn_openLoading" class="btn_openLoading" data-fileSource="loading6.js">打开loading</a>
		<a id="btn_openMaskLoading" class="btn_openMaskLoading" data-fileSource="loading6.js">打开maskloading</a>
		<a id="btn_hideLoading" class="btn_hideLoading" data-fileSource="loading6.js">关闭loading</a>
	</div>	
	<div style="text-align: center;">
		<h3>7.单圆扩散效果</h3>
		<a id="btn_openLoading" class="btn_openLoading" data-fileSource="loading7.js">打开loading</a>
		<a id="btn_openMaskLoading" class="btn_openMaskLoading" data-fileSource="loading7.js">打开maskloading</a>
		<a id="btn_hideLoading" class="btn_hideLoading" data-fileSource="loading7.js">关闭loading</a>
	</div>
	<div style="text-align: center;">
		<h3>8.多圆转圈效果效果</h3>
		<a id="btn_openLoading" class="btn_openLoading" data-fileSource="loading8.js">打开loading</a>
		<a id="btn_openMaskLoading" class="btn_openMaskLoading" data-fileSource="loading8.js">打开maskloading</a>
		<a id="btn_hideLoading" class="btn_hideLoading" data-fileSource="loading8.js">关闭loading</a>
	</div>							
	<!-- <script src="loading.js"></script> -->
	<script>
/*		document.getElementById("btn_openLoading").onclick=function(that){
			var src = that.path[0].getAttribute("data-fileSource");
			if(isInclude(src)){
				showLoading();
			}else{
				clear();
				loadjscssfile(src,"js","showLoading");
			}
			// var i = setInterval(function(){
			// 	console.log("flag",flag);
			// },100);
			// setTimeout(function(){
			// 	clearInterval(i);
			// },2000);			
		};
		document.getElementById("btn_openMaskLoading").onclick=function(){
			showMaskLoading();
		};
		document.getElementById("btn_hideLoading").onclick=function(){
			hideLoading();
		};*/

		var buttons = document.getElementsByTagName('a');
		for (var i = 0; i < buttons.length; i++) {
			var button = buttons[i];
			if(button.getAttribute("class")=="btn_openLoading"){
				button.onclick=function(that){
					var src = that.path[0].getAttribute("data-fileSource");
					if(isInclude(src)){
						showLoading();
					}else{
						clear(src);
						loadjscssfile(src,"js","showLoading");
					}					
				}
			}else if(button.getAttribute("class")=="btn_openMaskLoading"){
				button.onclick=function(that){
					var src = that.path[0].getAttribute("data-fileSource");
					if(isInclude(src)){
						showMaskLoading();
					}else{
						clear(src);
						loadjscssfile(src,"js","showMaskLoading");
					}					
				}				
			}else if(button.getAttribute("class")=="btn_hideLoading"){
				button.onclick=function(that){
					var src = that.path[0].getAttribute("data-fileSource");
					if(isInclude(src)){
						hideLoading();
					}else{
						clear(src);
						loadjscssfile(src,"js","hideLoading");
					}					
				}				
			}
			
		}


		function clear(src){
			removeElement(document.getElementById("spinner"));
			removeElement(document.getElementById("mask"));
			var docs = document.getElementsByTagName("script");
			removeElement(docs[0]);
/*			for(var i=0;i<docs.length;i++){
				var doc = docs[i];
				var currentSrc = doc.src;
				debugger
				if(currentSrc.indexOf(src)!=-1){
					removeElement(doc);
					debugger
					return;
				}
			}*/
		}

		//清除页面元素
		function removeElement(_element){
			if(_element){
				var _parentElement = _element.parentNode;
				if(_parentElement){
					_parentElement.removeChild(_element);
				}
			}
		}		

		//判断页面包含某个js或者css
		function isInclude(name){
		    var js= /js$/i.test(name);
		    var es=document.getElementsByTagName(js?'script':'link');
		    for(var i=0;i<es.length;i++) 
		    if(es[i][js?'src':'href'].indexOf(name)!=-1)return true;
		    return false;
		}

		//动态加载一个js/css文件
		function loadjscssfile(filename, filetype, callback){
			if (filetype=="js"){
				var url = window.location.href;
				debugger
				var fileref=document.createElement('script')
				fileref.async = "true";
				fileref.setAttribute("type","text/javascript")
				fileref.setAttribute("src", filename)
			}
			else if (filetype=="css"){
				var fileref=document.createElement("link")
				fileref.setAttribute("rel", "stylesheet")
				fileref.setAttribute("type", "text/css")
				fileref.setAttribute("href", filename)
			}
			if (typeof fileref!="undefined"){
				document.getElementsByTagName("head")[0].appendChild(fileref)
			}
		    if (fileref.addEventListener) {
		        fileref.addEventListener('load', function () {
		            console.log("loaded1");
		            if(callback=="showLoading"){
		            	showLoading();
		            }else if(callback=="hideLoading"){
		            	hideLoading();
		            }else if(callback=="showMaskLoading"){
		            	showMaskLoading();
		            }
		        }, false);
		    } else if (fileref.attachEvent) {
		        fileref.attachEvent('onreadystatechange', function () {
		            var target = window.event.srcElement;
		            if (target.readyState == 'loaded') {
		                console.log("loaded2");
			            if(callback=="showLoading"){
			            	showLoading();
			            }else if(callback=="hideLoading"){
			            	hideLoading();
			            }else if(callback=="showMaskLoading"){
			            	showMaskLoading();
			            }
		            }
		        });
		    }			
		}

	</script>  	
</body>
</html>